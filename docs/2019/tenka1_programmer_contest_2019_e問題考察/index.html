<!DOCTYPE html>
<html lang="en-us">

    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>へーさんのブログ  | Tenka1 Programmer Contest 2019 E問題考察</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114441596-3', 'auto');
	
	ga('send', 'pageview');
}
</script>


        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
        <link rel="stylesheet" href="https://hee-san.github.io/blog/css/blog.css" />

        

        <link rel="apple-touch-icon" sizes="57x57" href=https://hee-san.github.io/blog/img/favicon/apple-icon-57x57.png>
<link rel="apple-touch-icon" sizes="60x60" href=https://hee-san.github.io/blog/img/favicon/apple-icon-60x60.png>
<link rel="apple-touch-icon" sizes="72x72" href=https://hee-san.github.io/blog/img/favicon/apple-icon-72x72.png>
<link rel="apple-touch-icon" sizes="76x76" href=https://hee-san.github.io/blog/img/favicon/apple-icon-76x76.png>
<link rel="apple-touch-icon" sizes="114x114" href=https://hee-san.github.io/blog/img/favicon/apple-icon-114x114.png>
<link rel="apple-touch-icon" sizes="120x120" href=https://hee-san.github.io/blog/img/favicon/apple-icon-120x120.png>
<link rel="apple-touch-icon" sizes="144x144" href=https://hee-san.github.io/blog/img/favicon/apple-icon-144x144.png>
<link rel="apple-touch-icon" sizes="152x152" href=https://hee-san.github.io/blog/img/favicon/apple-icon-152x152.png>
<link rel="apple-touch-icon" sizes="180x180" href=https://hee-san.github.io/blog/img/favicon/apple-icon-180x180.png>
<link rel="icon" type="image/png" sizes="192x192" href=https://hee-san.github.io/blog/img/favicon/android-icon-192x192.png>
<link rel="icon" type="image/png" sizes="32x32" href=https://hee-san.github.io/blog/img/favicon/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="96x96" href=https://hee-san.github.io/blog/img/favicon/favicon-96x96.png>
<link rel="icon" type="image/png" sizes="16x16" href=https://hee-san.github.io/blog/img/favicon/favicon-16x16.png>
<link rel="manifest" href=https://hee-san.github.io/blog/img/favicon/manifest.json>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

        <meta name="twitter:card" content="summary_large_image" />
</meta>
<meta name="twitter:site" content="">
</meta>
<meta name="twitter:creator" content="">
</meta>
<meta name="twitter:title"
    content="<title>Tenka1 Programmer Contest 2019 E問題考察&nbsp;-&nbsp;へーさんのブログ</title>">
</meta>
<meta name="twitter:url" content="https://hee-san.github.io/blog/2019/tenka1_programmer_contest_2019_e%E5%95%8F%E9%A1%8C%E8%80%83%E5%AF%9F/">
</meta>
<meta name="twitter:description"
    content="">
</meta>

<meta name="twitter:image" content="https://hee-san.github.io/blog">
</meta>


        <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            ignoreClass: "gist"
        },
        "HTML-CSS": {matchFontHeight: false}
    });
</script>
<script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>

        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>

    </head>

    <body>

        
        <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a class="navbar-item" href="https://hee-san.github.io/blog">Home</a>
            </div>
        </nav>
        

        
        <section class="hero is-info is-medium">
            <div class="hero-body" style="background-image: url(https://hee-san.github.io/blog/img/bg-blog.jpg);">
                <div class="container has-text-centered">
                    <br>
                    <h1 class="title is-size-1">
                        
                        Tenka1 Programmer Contest 2019 E問題考察
                        
                    </h1>
                    
                </div>
            </div>
        </section>


<div class="container">
    <div class="section">
    

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                <p><a href="https://hee-san.github.io/blog/2019/tenka1_programmer_contest_2019_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">以前の記事</a>で、Tenka1 Programmer Contest 2019のC・D問題を解きました。</p>

<p>今回はE問題の考察をしたいと思います。</p>

<blockquote>
<h3 id="e-polynomial-divisors">E - Polynomial Divisors</h3>

<h5 id="問題文">問題文</h5>

<p>$N$次の整数係数多項式$f(x)=a_Nx^N+a_{N-1}x^{N-1}+&hellip;+a_0$が与えられます。</p>

<p>任意の整数$x$に対して$p$が$f(x)$を割り切るような素数$p$をすべて求めてください。</p>

<h5 id="制約">制約</h5>

<ul>
<li>$0 \leq N \leq 10^4$</li>
<li>$|a_i| \leq 10^9(0\leq i\leq N)$</li>
<li>$a_N \neq 0$</li>
<li>入力はすべて整数である</li>
</ul>

<p><cite><a href="https://atcoder.jp/contests/tenka1-2019/tasks/tenka1_2019_e">E - Polynomial Divisors</a></cite></p>
</blockquote>

<p>$p$が$f(x)$を割り切るとは、$f(x)\equiv 0 \pmod{p}$ということです。</p>

<hr />

<p>このような指数関数で、素数を法とする剰余に関するものには、<code>フェルマーの小定理</code>が使えそうだなと考えられます。
この定理を知っている人であれば、問題文を見た瞬間に、これを使うと予想を立てるでしょう。
それくらい頻繁に利用される、便利な定理です。</p>

<blockquote>
<h5 id="フェルマーの小定理">フェルマーの小定理</h5>

<p>素数$p$と、$p$の倍数でない任意の整数$a$について、以下が成り立つ。
$$a^{p-1} \equiv 1 \pmod{p}$$</p>
</blockquote>

<p>たとえば、
$$3^{6} = 729 \equiv 1 \pmod{7}$$
$$12^{4} = 20736 \equiv 1 \pmod{5}$$
など、成り立つことが確認できます。</p>

<p>フェルマーの小定理より、$f(x)$は次のように変形できます。</p>

<p>\begin{align}
f(x) &amp;= a_0 \\<br />
&amp;\quad+ (a_{1}+a_{p}+a_{2p-1}+&hellip;)x \\<br />
&amp;\quad+ (a_{2}+a_{p+1}+a_{2p}+&hellip;)x^2 \\<br />
&amp;\quad+ &hellip; \\<br />
&amp;\quad+ (a_{p-2}+a_{2p-3}+a_{3p-4}+&hellip;)x^{p-2} \\<br />
&amp;\quad+ (a_{p-1}+a_{2p-2}+a_{3p-3}+&hellip;)x^{p-1} \\<br />
&amp;= b_{p-1}x^{p-1}+b_{p-2}x^{p-2}+&hellip;+b_0
\end{align}</p>

<p>定数項を$(a_0+a_{p-1}+a_{2p-2}+a_{3p-3}+&hellip;)$とまとめたくなりますが、$f(0)$を考えると、それは間違いであることがわかります。</p>

<p>こうすることで、$N$次だった$f(x)$を、$p-1$次まで抑えることができました。</p>

<hr />

<p>つぎに、$f(x)\equiv 0$の条件を考えます。</p>

<p>たとえば<strong>各$b_i$の剰余が、すべて$0$である場合</strong>、$f(x)$の剰余も$0$となります。
これは簡単に判定できます。</p>

<p>もう1つの場合として、<strong>各$b_i$の剰余は$0$でなくとも、$f(x)\equiv 0$になる場合</strong>が想像できます。この場合は各項を独立して考えることはできないので、実装が難しそうです。
しかし、<strong>このような場合は存在しない</strong>と、数学的に証明できます。</p>

<p>証明には<code>剰余の定理</code>を用います。</p>

<blockquote>
<h5 id="剰余の定理">剰余の定理</h5>

<p>$f(x)$を$x-a$で割った余りは、$f(a)$に等しい。</p>
</blockquote>

<p>ここから<code>因数定理</code>などが導かれます。</p>

<blockquote>
<h5 id="因数定理">因数定理</h5>

<p>$f(a) = 0$ ならば、$f(x)$は$x-a$を因数に持つ。</p>
</blockquote>

<p>今回は$f(0) \equiv f(1) \equiv &hellip; \equiv f(p-1) \equiv 0 \pmod{p}$がわかっています。
これは等式でなく合同式なので、因数定理を直接使うことはできません。</p>

<p>剰余の定理から、つぎのことが言えます。</p>

<blockquote>
<p>$N$次整数多項式$f(x)$について、$f(a)\equiv 0 \pmod{p}$ならば、
$$f(x) = (x-a)g(x) + kp$$
と表せる。ただし、$g(x)$は$N-1$次整数多項式、$k$は整数。</p>
</blockquote>

<p>この式で$a=0$とすると、次の等式が得られます。
$$f(x) = xg(x) + k_0p$$</p>

<p>つぎに、この式で$x=1$とすると、$f(1)\equiv g(1)\equiv 0$なので、次の等式が得られます。
$$g(x) = (x-1)h(x) + k_1p$$</p>

<p>よって、
$$f(x) = x(x-1)h(x)+ k_1px + k_0p$$
が示されます。</p>

<p>これを繰り返すことで、
\begin{align}
f(x) &amp;= cx(x-1)(x-2)&hellip;(x-(p-1)) \\<br />
&amp;\quad+ p(k_0+k_1x+&hellip;+k_{p-1}x^{p-1})
\end{align}
が得られます。（係数$c$は定数。）</p>

<p>ここで係数$c$を持つ第一項は、$p$次の項です。
$f(x)$は$p-1$次で表現できるため、$c=0$であると言えます。</p>

<p>よって、次の等式が成り立ちます。
$$f(x) = pk_0+pk_1x+&hellip;+pk_{p-1}x^{p-1}$$
これは言い換えると、
$$b_i=pk_i$$
$$b_i \equiv 0 \pmod{p}$$
ということです。</p>

<p>よって、<strong>各$b_i$の剰余が、すべて$0$である</strong>ことが証明できました。</p>

<p>（公式解説の<a href="https://img.atcoder.jp/tenka1-2019/editorial.pdf">pdf</a>や<a href="https://youtu.be/uQvc7k2xamY">YouTube</a>では、簡潔に証明しています。自分はそれの正しさがわからなかったので、丁寧に証明してみました。）</p>

<hr />

<p>最後に、素数$p$の探索範囲を絞ります。</p>

<p>$f(0)\equiv 0 \pmod{p}$より、$p$は$f(0)$の素因数です。</p>

<p>よって$p$の候補は、$a_i$の総和を素因数分解することで得られます。</p>

<hr />

<p>解法をまとめると、次のようになります。</p>

<ol>
<li>$a_i$の総和を素因数分解し、$p$の候補を得る。</li>
<li>各$p$に対し、$b_i$を求める。</li>
<li>$b_i$の剰余がすべて$0$であれば、$p$を出力する。</li>
</ol>

<hr />

<p>こうして丁寧に考えると、やはりE問題は難しいなと感じました。
しかし本番では厳密な証明は不要なので、次に同じような問題が出れば、すぐに解けます。
問題をたくさん解いたり、数学の定理等を覚えたりすることで引き出しを増やしておくことが大切だと感じました。</p>
            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Share Buttons</h1>
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
            data-show-count="false">Tweet</a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>
</div>
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/atcoder">atcoder</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/gas">gas</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/matlab">matlab</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/web%E3%82%A2%E3%83%97%E3%83%AA">webアプリ</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/%E6%97%A5%E8%A8%98">日記</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">競技プログラミング</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%888%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月8日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">8 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%887%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月7日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">8 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019-09-05%E3%81%AE%E6%97%A5%E8%A8%98/">Android10感想（戻るボタン廃止）</a></h1>
            <time class="has-text-grey-light is-size-7">6 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%884%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月4日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">5 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_139_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 139 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">3 September 2019</time>
        
    </div>
</div>
    <br>
                
  



<div class="card">
    <div class="card-content">
        <h1 class="title is-5">Related posts</h1>
      
      
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_139_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 139 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">3 September 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_129_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 129 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">9 June 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/agc034_c%E5%95%8F%E9%A1%8C/">AGC034 C問題</a></h1>
            <time class="has-text-grey-light is-size-7">5 June 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B23/">Diverta 2019 Programming Contest 参加記録 3</a></h1>
            <time class="has-text-grey-light is-size-7">15 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B22/">Diverta 2019 Programming Contest 参加記録 2</a></h1>
            <time class="has-text-grey-light is-size-7">13 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B21/">Diverta 2019 Programming Contest 参加記録 1</a></h1>
            <time class="has-text-grey-light is-size-7">12 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/agc033_c%E5%95%8F%E9%A1%8C_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AGC033 C問題 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">9 May 2019</time>
      
    </div>
</div>

    
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
        <a href="https://hee-san.github.io/blog/archives/2019/09">2019/09</a> (8)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/08">2019/08</a> (1)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/06">2019/06</a> (2)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/05">2019/05</a> (7)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/04">2019/04</a> (4)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            <span class="icon is-large"><a href="https://twitter.com/hee_san_" class="mysocial"><i
                        class="fab fa-twitter fa-3x"></i></a></span>&nbsp;&nbsp;
            
            <span class="icon is-large"><a href="https://github.com/Hee-San" class="mysocial"><i
                        class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
            <br><br>
            Copyright &copy; へーさんのブログ 2019 - Theme by <a href="https://jeffprod.com"
                class="mysocial">JeffProd.com</a>
            - <a class="mysocial" href="https://hee-san.github.io/blog/about">About</a>
        </p>
    </div>
</footer>

</body>

</html>
