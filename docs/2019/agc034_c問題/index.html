<!DOCTYPE html>
<html lang="en-us">

    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>へーさんのブログ  | AGC034 C問題</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114441596-3', 'auto');
	
	ga('send', 'pageview');
}
</script>


        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
        <link rel="stylesheet" href="https://hee-san.github.io/blog/css/blog.css" />

        

        <link rel="apple-touch-icon" sizes="57x57" href=https://hee-san.github.io/blog/img/favicon/apple-icon-57x57.png>
<link rel="apple-touch-icon" sizes="60x60" href=https://hee-san.github.io/blog/img/favicon/apple-icon-60x60.png>
<link rel="apple-touch-icon" sizes="72x72" href=https://hee-san.github.io/blog/img/favicon/apple-icon-72x72.png>
<link rel="apple-touch-icon" sizes="76x76" href=https://hee-san.github.io/blog/img/favicon/apple-icon-76x76.png>
<link rel="apple-touch-icon" sizes="114x114" href=https://hee-san.github.io/blog/img/favicon/apple-icon-114x114.png>
<link rel="apple-touch-icon" sizes="120x120" href=https://hee-san.github.io/blog/img/favicon/apple-icon-120x120.png>
<link rel="apple-touch-icon" sizes="144x144" href=https://hee-san.github.io/blog/img/favicon/apple-icon-144x144.png>
<link rel="apple-touch-icon" sizes="152x152" href=https://hee-san.github.io/blog/img/favicon/apple-icon-152x152.png>
<link rel="apple-touch-icon" sizes="180x180" href=https://hee-san.github.io/blog/img/favicon/apple-icon-180x180.png>
<link rel="icon" type="image/png" sizes="192x192" href=https://hee-san.github.io/blog/img/favicon/android-icon-192x192.png>
<link rel="icon" type="image/png" sizes="32x32" href=https://hee-san.github.io/blog/img/favicon/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="96x96" href=https://hee-san.github.io/blog/img/favicon/favicon-96x96.png>
<link rel="icon" type="image/png" sizes="16x16" href=https://hee-san.github.io/blog/img/favicon/favicon-16x16.png>
<link rel="manifest" href=https://hee-san.github.io/blog/img/favicon/manifest.json>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

        <meta name="twitter:card" content="summary_large_image" />
</meta>
<meta name="twitter:site" content="">
</meta>
<meta name="twitter:creator" content="">
</meta>
<meta name="twitter:title"
    content="<title>AGC034 C問題&nbsp;-&nbsp;へーさんのブログ</title>">
</meta>
<meta name="twitter:url" content="https://hee-san.github.io/blog/2019/agc034_c%E5%95%8F%E9%A1%8C/">
</meta>
<meta name="twitter:description"
    content="">
</meta>

<meta name="twitter:image" content="https://hee-san.github.io/blog">
</meta>


        <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            ignoreClass: "gist"
        },
        "HTML-CSS": {matchFontHeight: false}
    });
</script>
<script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>

        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>

    </head>

    <body>

        
        <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a class="navbar-item" href="https://hee-san.github.io/blog">Home</a>
            </div>
        </nav>
        

        
        <section class="hero is-info is-medium">
            <div class="hero-body" style="background-image: url(https://hee-san.github.io/blog/img/bg-blog.jpg);">
                <div class="container has-text-centered">
                    <br>
                    <h1 class="title is-size-1">
                        
                        AGC034 C問題
                        
                    </h1>
                    
                </div>
            </div>
        </section>


<div class="container">
    <div class="section">
    

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                <p>先日（2019/06/02）、AtCoderで開催された<a href="https://atcoder.jp/contests/agc034">AtCoder Grand Contest 034</a>に参加しました。
久々のブログ更新です。</p>

<p>前回からかなり時間が開いてしまいました。</p>

<p>研究が忙しくなっていたためです。
現在も十分忙しいのですが、実験終了の待ち時間に余裕が出てきたため、久々に投稿してみようと思いました。</p>

<p><img src="/blog/img/AGC034.png" alt="レートグラフ" /></p>

<p>忙しい間もコンテスト参加は欠かさなかったので、レートは少しずつ上ってきています。</p>

<p>精進できていない（過去問を解くなどの努力ができていない）ため、伸び率は低いですが、次の青色が見えるようになってきたのはとても嬉しことです。</p>

<p>少し書かないうちに文章力が落ちてしまった気がしますが、C問題の考察に入っていきたいと思います。</p>

<hr />

<blockquote>
<h3 id="c-tests">C - Tests</h3>

<p>(800点)</p>

<h5 id="問題文">問題文</h5>

<p>高橋くんと青木くんは$1$から$N$までの番号がついたテストを受けようとしています。
二人はこのテストの結果を使って勝負することにしました。
具体的には、次のようにして勝敗を決めます。</p>

<ul>
<li>高橋くんが各テスト$i$について、その重要度$c_i$を決める。
ただしこの値は$l_i$以上$u_i$以下の整数である必要がある。</li>
<li>$\sum_{i=1}^{N} c_i \times$(高橋くんのテスト$i$の点数)$\ $を$A$、$\sum_{i=1}^{N} c_i \times$(青木くんのテスト$i$の点数)$\ $を$B$とする。
$A \geq B$なら高橋くんの勝ち、$A&lt;B$なら青木くんの勝ち。</li>
</ul>

<p>高橋くんはエスパーなので、青木くんがテスト$i$で$b_i$点をとることがわかっています。</p>

<p>高橋くんはこのままだとすべてのテストで$0$点をとってしまいますが、1時間勉強するごとに、好きなテストの点数を1だけ上げることができます。
(1時間単位でしか勉強できません。)
ただしテストはすべて$X$点満点なので、$X$より大きい点数にすることはできません。</p>

<h5 id="制約">制約</h5>

<ul>
<li>$1 \leq N \leq 10^5$</li>
<li>$1 \leq X \leq 10^5$</li>
<li>$0 \leq b_i \leq X \  (i \leq i \leq N)$</li>
<li>$1 \leq l_i \leq u_i \leq 10^5 \  (i \leq i \leq N)$</li>
</ul>

<p><cite><a href="https://atcoder.jp/contests/agc034/tasks/agc034_c">AGC034 C - Tests</a></cite></p>
</blockquote>

<p>まず、高橋君はほぼすべての問題に対し、満点をとるまで勉強するか、まったく勉強しないかのどちらかで良いと気づきました。
正確には、<strong>中途半端に勉強するものは高々1つ</strong>、ということです。</p>

<p>次に、どうにかして、<strong>各テストに優先順位をつけたい</strong>とおもいます。
勉強する優先順位がつけられれば、後は何点分勉強すればよいかという問題だけになるからです。</p>

<p>優先順位は、そのテストを勉強した際、どれくらい勝負に寄与するかを考えると良さそうです。
ノー勉の状態を基準に考えてみましょう。</p>

<p>まず、あるテスト$i$を満点まで勉強したときの寄与はどれくらいになるでしょうか。
点数が青木くんに勝っているとき、重要度は最大の$u_i$にするのがお得です。
このとき、$u_i\times(X-b_i)$のアドバンテージを得るでしょう。</p>

<p>今はノー勉の状態を基準に考えているので、基準値からの寄与を考えます。
このとき、重要度は最小の$l_i$にするのが良いです。
ノー勉の場合、$l_i\times b_i$のディスアドバンテージがある状態です。</p>

<p>よって、<strong>あるテスト$i$を満点まで勉強したときの寄与$D_i$</strong>は、
$$D_i=u_i\times(X-b_i)+l_i\times b_i$$
と計算できます。</p>

<p>この寄与$D_i$が大きいものから、順に勉強してゆくのが良さそうです。
すべてのテストについて$D_i$を計算し、降順にソートすれば扱いやすそうです。
（$D_i$が等しいテストの比較はについては後述します。）</p>

<p>ここまでの計算量は、$N$個のテストについて$O(1)$で$D_i$を計算、$O(N\log N)$でソートするので、$O(N+N\log N)$、つまり$O(N\log N)$です。</p>

<hr />

<p>それでは、この寄与$D_i$の降順に、何点分のテスト勉強をすれば良いのでしょう。
僕はこの部分に悩まされ、問題Cを解くことができませんでした。</p>

<p>模範解答では、<strong>二分探索</strong>を用います。</p>

<p>簡単な話でした。
$k$点分勉強するとき、$k$が増えると$D_i$の和も増えてゆきます。
そして、寄与の和が$\sum_{i=1}^{N} l_i b_i$を超えるような最小の$k$が答えです。
これは線形計画問題で、直接答えを求めることは難しいですが、ある$k$における寄与の和は直接出せそうなので、二分探索が良いです。</p>

<p>（ある$k$における結果が漸化式のように表されるときには、動的計画法などを用います。また、重要度$c_i$が$u_i$または$l_i$と極値を取ることは、線型計画問題の性質からも言えます。）</p>

<p>さて、<strong>ある$k$を決めて、$k$点分勉強する</strong>としましょう。
このとき、青木くんに勝てるか否かが判断できれば、$k$について二分探索を実行できます。</p>

<p>するとまずは、<strong>寄与$D_i$の降順に並べたテストのうち、前から$\lfloor \frac{k}{X} \rfloor$個は満点まで勉強すれば良い</strong>とわかります。
そして残りの$k\%X$点分を、残りのどれか1つのテストについて勉強します。</p>

<p>ここで注意が必要です。
残りの$k\%X$点分勉強するテストは、寄与$D_i$降順テストの$\lfloor \frac{k}{X} \rfloor+1$個目とは限りません。
寄与$D_i$は、あるテスト$i$を満点まで勉強したという仮定での結果です。
中途半端に勉強するテストの寄与は$D_i$ではありませんし、テストごとの大小関係も変わってきます。</p>

<p><strong>最後にどのテストを選ぶかは、残りのテストについて全探索する必要があります。</strong>
あるテスト$i$を$k\%X$点だけ勉強するとき、$k\%X &lt; b_i$ならその寄与は
$$l_i\times(k\%X)$$
となります。
$k\%X \geq b_i$ならその寄与は
$$u_i\times((k\%X)-b_i)+l_i\times b_i$$
となります。
この寄与が一番大きかったテストについて、勉強すれば最善です。</p>

<p>こうして、$k$点分勉強したときの寄与がすべて計算できました。
その<strong>合計が$\sum_{i=1}^{N} l_i b_i$を超える最小の$k$を二分探索で探せば、答えの$k$が見つかります。</strong></p>

<p>$k$を決めたときの寄与は、計算量$O(N)$で計算できます。
また、$k$の範囲は$0$から$NX$の間なので、二分探索の計算量は$O(N\log NX)$となります。</p>

<p>前半のソートと合わせても、この解法の計算量は$O(N\log NX)$となります。</p>
            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Share Buttons</h1>
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
            data-show-count="false">Tweet</a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>
</div>
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/atcoder">atcoder</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/gas">gas</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/matlab">matlab</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/web%E3%82%A2%E3%83%97%E3%83%AA">webアプリ</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/%E6%97%A5%E8%A8%98">日記</a></span>
        
            <span class="tag"><a href="https://hee-san.github.io/blog/tags/%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">競技プログラミング</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%888%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月8日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">8 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%887%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月7日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">8 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019-09-05%E3%81%AE%E6%97%A5%E8%A8%98/">Android10感想（戻るボタン廃止）</a></h1>
            <time class="has-text-grey-light is-size-7">6 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/2019%E5%B9%B49%E6%9C%884%E6%97%A5%E3%81%AE%E6%97%A5%E8%A8%98/">2019年9月4日の日記</a></h1>
            <time class="has-text-grey-light is-size-7">5 September 2019</time>
        
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_139_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 139 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">3 September 2019</time>
        
    </div>
</div>
    <br>
                
  



<div class="card">
    <div class="card-content">
        <h1 class="title is-5">Related posts</h1>
      
      
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_139_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 139 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">3 September 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/atcoder_beginner_contest_129_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AtCoder Beginner Contest 129 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">9 June 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B23/">Diverta 2019 Programming Contest 参加記録 3</a></h1>
            <time class="has-text-grey-light is-size-7">15 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B22/">Diverta 2019 Programming Contest 参加記録 2</a></h1>
            <time class="has-text-grey-light is-size-7">13 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/diverta_2019_programming_contest_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B21/">Diverta 2019 Programming Contest 参加記録 1</a></h1>
            <time class="has-text-grey-light is-size-7">12 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/agc033_c%E5%95%8F%E9%A1%8C_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AGC033 C問題 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">9 May 2019</time>
      
            <h1><a href="https://hee-san.github.io/blog/2019/agc033_b%E5%95%8F%E9%A1%8C_%E5%8F%82%E5%8A%A0%E8%A8%98%E9%8C%B2/">AGC033 B問題 参加記録</a></h1>
            <time class="has-text-grey-light is-size-7">6 May 2019</time>
      
    </div>
</div>

    
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
        <a href="https://hee-san.github.io/blog/archives/2019/09">2019/09</a> (8)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/08">2019/08</a> (1)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/06">2019/06</a> (2)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/05">2019/05</a> (7)<br>
        
        <a href="https://hee-san.github.io/blog/archives/2019/04">2019/04</a> (4)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            <span class="icon is-large"><a href="https://twitter.com/hee_san_" class="mysocial"><i
                        class="fab fa-twitter fa-3x"></i></a></span>&nbsp;&nbsp;
            
            <span class="icon is-large"><a href="https://github.com/Hee-San" class="mysocial"><i
                        class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
            <br><br>
            Copyright &copy; へーさんのブログ 2019 - Theme by <a href="https://jeffprod.com"
                class="mysocial">JeffProd.com</a>
            - <a class="mysocial" href="https://hee-san.github.io/blog/about">About</a>
        </p>
    </div>
</footer>

</body>

</html>
